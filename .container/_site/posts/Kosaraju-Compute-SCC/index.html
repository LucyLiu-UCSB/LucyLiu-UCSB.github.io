<!DOCTYPE html><html lang="en"> <!-- The Head © 2017-2019 Cotes Chung MIT License --><head><title>Kosaraju's algorithm to find SCCs | Lucy's Blog</title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v3.8.6" /><meta property="og:title" content="Kosaraju’s algorithm to find SCCs" /><meta name="author" content="Lucy Liu" /><meta property="og:locale" content="en_US" /><meta name="description" content="Definition of Strongly Connected Components The question addressed in this post is to find the Strongly Connected Components (SCCs) in a directed graph G. These SCCs is a partition of G, which means SCCs are mutually disjoint non-empty subgraphs whose union is G. This is the first graph search question I’ve learned in the online courses, Algorithms: Design and Analysis. I decided to write a summary here because the question is interesting; it uses the stack data structure to accelerate the computation the algorithm is blazingly fast with running time \(O(V + E)\), where \(V\) and \(E\) are the numbers of vertex and edge respectively." /><meta property="og:description" content="Definition of Strongly Connected Components The question addressed in this post is to find the Strongly Connected Components (SCCs) in a directed graph G. These SCCs is a partition of G, which means SCCs are mutually disjoint non-empty subgraphs whose union is G. This is the first graph search question I’ve learned in the online courses, Algorithms: Design and Analysis. I decided to write a summary here because the question is interesting; it uses the stack data structure to accelerate the computation the algorithm is blazingly fast with running time \(O(V + E)\), where \(V\) and \(E\) are the numbers of vertex and edge respectively." /><link rel="canonical" href="http://localhost:4000/posts/Kosaraju-Compute-SCC/" /><meta property="og:url" content="http://localhost:4000/posts/Kosaraju-Compute-SCC/" /><meta property="og:site_name" content="Lucy’s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2019-11-29T14:12:00-08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Kosaraju’s algorithm to find SCCs" /><meta name="twitter:site" content="@LucyLiu84049511" /><meta name="twitter:creator" content="@Lucy Liu" /><meta name="google-site-verification" content="828U5Odxo38lGZ7ca6xyIc_r3oCovf3Xsr-XyShs3Ek" /> <script type="application/ld+json"> {"description":"Definition of Strongly Connected Components The question addressed in this post is to find the Strongly Connected Components (SCCs) in a directed graph G. These SCCs is a partition of G, which means SCCs are mutually disjoint non-empty subgraphs whose union is G. This is the first graph search question I’ve learned in the online courses, Algorithms: Design and Analysis. I decided to write a summary here because the question is interesting; it uses the stack data structure to accelerate the computation the algorithm is blazingly fast with running time \\(O(V + E)\\), where \\(V\\) and \\(E\\) are the numbers of vertex and edge respectively.","@type":"BlogPosting","headline":"Kosaraju’s algorithm to find SCCs","dateModified":"2019-11-29T20:58:47-08:00","datePublished":"2019-11-29T14:12:00-08:00","url":"http://localhost:4000/posts/Kosaraju-Compute-SCC/","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/Kosaraju-Compute-SCC/"},"author":{"@type":"Person","name":"Lucy Liu"},"@context":"https://schema.org"}</script> <!-- The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps Generated by: https://www.favicon-generator.org/ © 2019 Cotes Chung Published under the MIT license --><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/main.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script> <script> document.jQuery || document.write('<script src="/assets/lib/jquery-3.4.1.min.js"><\/script>'); </script> <script src="https://cdn.jsdelivr.net/npm/popper.js@1.15.0/dist/umd/popper.min.js" integrity="sha256-fTuUgtT7O2rqoImwjrhDgbXTKUwyxxujIMRIK7TbuNU=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha256-5+02zu5UULQkO7w1GIr6vftCgMfFdZcAHeDtFnKZsBs=" crossorigin="anonymous"></script> <script src="/assets/js/dist/commons.js" async></script> <script src="/assets/js/dist/timeago.min.js"></script><link rel="stylesheet" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.css" /> <script src="/assets/lib/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script> <script src="/assets/js/dist/toc.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"> <!-- The Side Bar © 2017-2019 Cotes Chung MIT License --><div id="nav-wrap"><div id="profile-wrap" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/Lucy.png"></img> </a></div><div class="profile-text mt-3"><div id="site-title"> <a href="/">Lucy's Blog</a></div><div id="site-subtitle" class="font-italic">Learning for the sake of Learning</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-3 mr-4 hidden"></i> <span>HOME</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-3 mr-4 hidden"></i> <span>CATEGORIES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-3 mr-4 hidden"></i> <span>TAGS</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-3 mr-4 hidden"></i> <span>ARCHIVES</span> </a></li><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-3 mr-4 hidden"></i> <span>ABOUT</span> </a></li></ul></div><div class="contact d-flex justify-content-around mt-4"> <a href="https://github.com/LucyLiu-UCSB" target="_blank"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/LucyLiu84049511" target="_blank"> <i class="fab fa-twitter"></i> </a> <a href="javascript:window.open('mailto:' + ['xiliu','ucsb.edu'].join('@'))"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" target="_blank"> <i class="fas fa-rss"></i> </a></div></div><div id="main-wrap"> <!-- The Top Bar © 2017-2019 Cotes Chung MIT License --><div id="topbar" class="bg-white row justify-content-center topbar-down"><div id="topbar-main" class="d-flex h-100 align-items-center justify-content-between col-12 col-md-12 col-lg-11 col-xl-11 pl-md-2 pr-md-2 pl-lg-2 pr-lg-2"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Kosaraju's algorithm to find SCCs</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrap"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" placeholder="Search..."> </span> <a href="javascript:;">Cancel</a></div></div><div id="main"><div class="row justify-content-center bg-white"> <!-- Fixed kramdown code highlight rendering: https://github.com/penibelst/jekyll-compress-html/issues/101 https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901 --> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> <!-- Define the liquid date formats. © 2019 Cotes Chung Published under the MIT License --><div class="col-12 col-lg-11 col-xl-8"><div id="post-wrap" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4 pl-xl-3"><div class="post"><h1 data-toc-skip>Kosaraju's algorithm to find SCCs</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago" data-toggle="tooltip" title="Fri, Nov 29, 2019, 2:12 PM -0800"> Nov 29, 2019 <i class="hidden">2019-11-29T14:12:00-08:00</i> </span> on <a href='/categories/computer-science/'>Computer Science</a>, <a href='/categories/algorithm/'>Algorithm</a></div><div> Updated <span class="timeago lastmod" data-toggle="tooltip" title="Fri, Nov 29, 2019, 8:58 PM -0800"> Nov 29, 2019 <i class="hidden">2019-11-29T20:58:47-08:00</i> </span></div></div><div class="post-content"><h2 id="definition-of-strongly-connected-components">Definition of Strongly Connected Components</h2><p>The question addressed in this post is to find the Strongly Connected Components (SCCs) in a directed graph G. These SCCs is a partition of G, which means SCCs are mutually disjoint non-empty subgraphs whose union is G. This is the first graph search question I’ve learned in the online courses, <a href="https://lagunita.stanford.edu/courses">Algorithms: Design and Analysis</a>. I decided to write a summary here because</p><ol><li>the question is interesting;</li><li>it uses the stack data structure to accelerate the computation</li><li>the algorithm is blazingly fast with running time \(O(V + E)\), where \(V\) and \(E\) are the numbers of vertex and edge respectively.</li></ol><p>Kosaraju’s algorithm is a two-pass algorithm. In the first pass, a Depth First Search (DFS) algorithm is run on the inverse graph to computing finishing time; the second pass uses DFS again to find out all the SCCs where the start note of each SCC follows the finishing time obtained in the first pass. The following analysis and code break the question into three pieces, reverse a directed graph, first DFS computing finishing time and second DFS finding SCCs.</p><p><img src="/assets/img/sample/scc1.jpg" alt="scc1" width="700" class="center" /></p><h2 id="reverse-a-directed-graph">Reverse a directed graph</h2><p>Suppose the graph is represented by the adjacency list. <code class="highlighter-rouge">9: [7, 3]</code> represents vertex with label 9 has two outgoing edges to the vertices with label 7 and 3.</p><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>adj_lst
defaultdict(list,
            {7: [1],
             4: [7],
             1: [4],
             9: [7, 3],
             6: [9],
             8: [6, 5],
             2: [8],
             5: [2],
             3: [6]})
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="k">class</span> <span class="nc">Graph</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">adj_lst</span><span class="p">):</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span> <span class="o">=</span> <span class="n">adj_lst</span>  
    
    <span class="k">def</span> <span class="nf">addEdge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex1</span><span class="p">,</span> <span class="n">vertex2</span><span class="p">):</span> <span class="c1"># add an edge from vertex1 to vertex2
</span>        <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">vertex1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex2</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">reverseGraph</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="n">inverseG</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">inverseG</span><span class="o">.</span><span class="n">addEdge</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">inverseG</span>
</pre></table></code></div></div><h2 id="first-dfs-computes-finishing-time">First DFS computes finishing time</h2><p>We randomly select a vertex and go along the directed edges as far as possible. The if we arrive at a vertex, who does not have an outgoing edge connecting to an unvisited vertex, we push the vertex to the stack and come back via the way we reach it. For instance, in the following reversed graph, we choose <code class="highlighter-rouge">9</code> =&gt; <code class="highlighter-rouge">6</code> =&gt; <code class="highlighter-rouge">3</code>, since <code class="highlighter-rouge">3</code> does not have an outgoing edge connecting to any unvisited vertex, we push <code class="highlighter-rouge">3</code> to the stack and come back to <code class="highlighter-rouge">6</code>. <code class="highlighter-rouge">6</code> still has another outgoing edge to <code class="highlighter-rouge">8</code>. Then <code class="highlighter-rouge">6</code> =&gt; <code class="highlighter-rouge">8</code> =&gt; <code class="highlighter-rouge">2</code> \(\cdots\).</p><p><img src="/assets/img/sample/scc2.jpg" alt="scc2" width="700" class="center" /></p><p>In the example, we proceed like:</p><ul><li><code class="highlighter-rouge">9</code> =&gt; <code class="highlighter-rouge">6</code> =&gt; <code class="highlighter-rouge">3</code>(push) =&gt; <code class="highlighter-rouge">6</code> =&gt; <code class="highlighter-rouge">8</code> =&gt; <code class="highlighter-rouge">2</code> =&gt; <code class="highlighter-rouge">5</code>(push) =&gt; <code class="highlighter-rouge">2</code>(push) =&gt; <code class="highlighter-rouge">8</code>(push) =&gt; <code class="highlighter-rouge">6</code>(push) =&gt; <code class="highlighter-rouge">9</code>(push)</li><li><code class="highlighter-rouge">7</code> =&gt; <code class="highlighter-rouge">4</code> =&gt; <code class="highlighter-rouge">1</code> (push) =&gt; <code class="highlighter-rouge">4</code>(push) =&gt; <code class="highlighter-rouge">7</code>(push)</li></ul><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Graph</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="nf">finishingTimeStack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex</span><span class="p">,</span> <span class="n">visited</span><span class="p">,</span> <span class="n">stack</span><span class="p">):</span>
        <span class="s">'''
        visited: a dict to record visited vertices
        vertex: current vertex 
        stack: push vertex to stack as DFS proceeding
        '''</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">vertex</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">finishingTimeStack</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">visited</span><span class="p">,</span> <span class="n">stack</span><span class="p">)</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
</pre></table></code></div></div><h2 id="second-dfs-computes-sccs">Second DFS computes SCCs</h2><p>After we get the finishing time via the first DFS, we change the name of notes to its finishing time in the original graph G. We are going to process the nodes from the highest label down to the lowest label 1. For both the first DFS and second DFS, to guarantee a visit of every note, an outer loop is necessary.</p><p><img src="/assets/img/sample/scc3.jpg" alt="scc3" width="700" class="center" /></p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Graph</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="nf">getOneSCC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertex</span><span class="p">,</span> <span class="n">visited</span><span class="p">,</span> <span class="n">scc</span><span class="p">):</span>
        <span class="n">scc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vertex</span><span class="p">)</span>
        <span class="n">visited</span><span class="p">[</span><span class="n">vertex</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="p">[</span><span class="n">vertex</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">getOneSCC</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">visited</span><span class="p">,</span> <span class="n">scc</span><span class="p">)</span>
       
    <span class="k">def</span> <span class="nf">computeSCCs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">stack</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># order of stack is the finishing time
</span>        
        <span class="c1">### First DFS: compute the finishing time
</span>        <span class="n">visited</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span> <span class="c1"># initialized all notes as unvisited
</span>        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">graph</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span> <span class="c1"># use outer loop to ganrantee every note will be visited
</span>            <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">finishingTimeStack</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">visited</span><span class="p">,</span> <span class="n">stack</span><span class="p">)</span>
        
        <span class="c1">### Compute a inverse graph
</span>        <span class="n">inverG</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reverseGraph</span><span class="p">()</span>
        
        <span class="c1">### Second DFS: compute the SCCs
</span>        <span class="n">SCC_lst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">visited</span> <span class="o">=</span>  <span class="n">defaultdict</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span> <span class="c1"># initialized all notes as unvisited 
</span>        <span class="k">while</span> <span class="n">stack</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
                <span class="n">scc</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">inverG</span><span class="o">.</span><span class="n">getOneSCC</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">visited</span><span class="p">,</span> <span class="n">scc</span><span class="p">)</span>
                <span class="n">SCC_lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SCC_lst</span>
</pre></table></code></div></div><h2 id="run-computesccs-on-the-example">Run <code class="highlighter-rouge">computeSCCs</code> on the example</h2><p>Note that in the given code, actually, we need to put the adjacent list of the inverse graph as the argument. This is because, in function <code class="highlighter-rouge">finishingTimeStack</code>, we compute the finishing time of the input <code class="highlighter-rouge">adj_lst</code>, not its inverse. And function <code class="highlighter-rouge">computeSCCs</code> compute the SCCs of the inverse of <code class="highlighter-rouge">adj_lst</code>.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="n">oriG</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">adj_lst</span><span class="p">)</span>
<span class="n">invG</span> <span class="o">=</span> <span class="n">oriG</span><span class="o">.</span><span class="n">reverseGraph</span><span class="p">()</span>
<span class="n">invG</span><span class="o">.</span><span class="n">computeSCCs</span><span class="p">()</span>
</pre></table></code></div></div><div class="highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[[1, 4, 7], [9, 3, 6], [8, 5, 2]]
</pre></table></code></div></div><p>Note that if you use Python to run long recursion, please add the following code to manage stack size and recursion limit in Linux OS.</p><div class="language-python highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">resource</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">resource</span><span class="o">.</span><span class="n">setrlimit</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">RLIMIT_STACK</span><span class="p">,</span> <span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">RLIM_INFINITY</span><span class="p">,</span> <span class="n">resource</span><span class="o">.</span><span class="n">RLIM_INFINITY</span><span class="p">))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">setrecursionlimit</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="mi">17</span><span class="p">)</span>
</pre></table></code></div></div></div><div class="post-tail text-muted"><div class="mb-4"> <a href="/tags/directed-graph/" class="post-tag no-text-decoration" >Directed Graph</a>&ensp; <a href="/tags/recursion/" class="post-tag no-text-decoration" >Recursion</a></div></div></div><!-- The related posts of current post. Placed in the bottom of every single post. © 2019 Cotes Chung Published under the MIT License --><div id="related-posts" class="mt-4 mb-4 pb-3"><h3 class="pt-2 mt-1 mb-4" data-toc-skip>Related Posts</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/count-inversion-with-merge-sort/"><div class="card-body"> <span class="timeago small"> Nov 22, 2019 <i class="hidden">2019-11-22T14:21:00-08:00</i> </span><h3 class="pt-0 mt-2 mb-3" data-toc-skip>Count inversion with merge sort</h3><div class="text-muted small"><p>Question Given a list of number, how many inversion pairs are there? If the list is [1, 3, 5, 2, 4, 6], there are three inversions: (3, 2), (3, 4), (3, 6). A brute force method would be using two ...</p></div></div></a></div><div class="card"> <a href="/posts/Dynamic-Programming/"><div class="card-body"> <span class="timeago small"> Nov 25, 2019 <i class="hidden">2019-11-25T23:37:00-08:00</i> </span><h3 class="pt-0 mt-2 mb-3" data-toc-skip>Dynamic Programming</h3><div class="text-muted small"><p>I am following the free online courses, Algorithms: Design and Analysis, on Stanford Lagnuita to learn Basic CS algorithms. While I am capable of understanding the Part1 fast and smoothly, I paused...</p></div></div></a></div></div></div><div class="post-pager d-flex justify-content-between"> <a href="/posts/Dynamic-Programming/" class="btn btn-outline-primary"> <i class="fas fa-angle-left mr-1"></i> OLDER POST </a> <a href="/posts/Some-useful-operations-in-MySQL-easy-level/" class="btn btn-outline-primary"> NEWER POST <i class="fas fa-angle-right ml-1"></i> </a></div><!-- The Disqus lazy loading. Powered by: https://osvaldas.info/lazy-loading-disqus-comments © 2019 Cotes Chung MIT License --><div id="disqus" class="pt-2 pb-4"><p class="font-italic text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/lib/jquery.disqusloader.min.js"></script> <script> var options = { scriptUrl: '//LucyLiu.disqus.com/embed.js', disqusConfig: function() { this.page.url = 'http://localhost:4000/posts/Kosaraju-Compute-SCC/'; this.page.identifier = '/posts/Kosaraju-Compute-SCC/'; } }; $.disqusLoader('#disqus', options); </script></div></div><!-- The Pannel on right side (Desktop views) © 2017-2019 Cotes Chung MIT License --><div id="panel-wrap" class="col-xl-3 pl-2 topbar-down"><div class="access"><div id="access-lastmod" class="post mb-4""><h3 data-toc-skip>Recent Update</h3><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Some-useful-operations-in-MySQL-easy-level/">Some useful operations in MySQL--Easy level</a></li><li><a href="/posts/Some-useful-operations-in-MySQL-median-level/">Some useful operations in MySQL--Median level</a></li><li><a href="/posts/Asterisk-in-Python/">Asterisk in Python</a></li><li><a href="/posts/Embedding-algorithm1-MDS/">Embedding algorithms 1 -- Multidimensional scaling</a></li><li><a href="/posts/math-definition-of-manifold/">Mathematical definition of Manifold</a></li></ul></div><div id="access-tags"><h3 data-toc-skip>Trending Tags</h3><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/manifold/">Manifold</a> <a class="post-tag" href="/tags/embedding/">Embedding</a> <a class="post-tag" href="/tags/sql/">SQL</a> <a class="post-tag" href="/tags/recursion/">Recursion</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/dynamic-programming/">Dynamic Programming</a> <a class="post-tag" href="/tags/divide&conquer/">Divide&Conquer</a> <a class="post-tag" href="/tags/directed-graph/">Directed Graph</a></div></div></div><div id="toc-wrap" class="pl-0 pr-4"><h3 data-toc-skip class="pl-3 pt-2">Contents</h3><nav id="toc" data-toggle="toc"></nav></div></div></div><!-- The Footer © 2017-2019 Cotes Chung MIT License --><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="copyright"><p class="mb-0"> © 2019<a href="https://twitter.com/LucyLiu84049511" class="ml-1">Lucy Liu</a>. <br>Powered by <a href="https://jekyllrb.com" target="_blank">Jekyll</a> & <a href="https://github.com/cotes2020/jekyll-theme-chirpy/">Chirpy</a>, hosted on <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.</p></div><div class="license"><p class="mb-0"> The blog posts on this site are licensed under the <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p></div></div></footer></div><!-- The Search results © 2017-2019 Cotes Chung MIT License --><div id="search-result-wrap"><div class="row justify-content-center bg-white"><div class="col-12 col-md-12 col-lg-11 col-xl-9 pl-xl-5 pr-xl-5 pb-5 mt-3 mb-3"><h2 class="mt-3 pt-3 ml-3 ml-md-5 ml-lg-0" data-toc-skip>Search Results</h2><div class="post-content ml-1 ml-md-5 ml-lg-0"><ul id="search-results" ></ul></div></div></div></div></div><div id="mask"></div><!-- The Search © 2017-2019 Cotes Chung MIT License --> <script src="/assets/lib/simple-jekyll-search-1.7.1.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/search.json' }) </script> <a id="back-to-top" href="#" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a>
